\documentclass{article}

\title{CS 579 Project: Extension Complexity of Polytopes in Combinatorial Optimization}
\author{Vasilis Livanos, Manuel Torres \\ Net IDs: livanos3, manuelt2}
\date{May 2, 2018}

\usepackage{amsmath, amssymb}  
\usepackage{fullpage}  
\usepackage{amsthm}  
\usepackage{mathtools}  
\usepackage{complexity}

\newtheorem{theorem}{\sc Theorem}
\newtheorem{lemma}[theorem]{\sc Lemma}
\newtheorem{prop}[theorem]{\sc Proposition}
\newtheorem{corollary}[theorem]{\sc Corollary}
\newtheorem{fact}[theorem]{\sc Fact}
\newtheorem{probstate}[theorem]{\sc Problem Statement}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{\sc Remark}
\newtheorem{claim}[theorem]{\sc Claim}
\newtheorem{observation}[theorem]{\sc Observation}


\usepackage{hyperref}  % used to hyperlink citations to bibliography
\hypersetup{
    colorlinks=true,
    linkcolor=[rgb]{0,0,0.6},
    citecolor=[rgb]{0,0,0.6}
} % changes color of hyperlinks to help notify the reader of the hyperlinks

\newcommand{\cetal}{\textit{et al.\@}}  % shortcut for etal to be used when no space is desired
\newcommand{\etal}{\textit{et al.\@\ }}  % shortcut for etal to be used in regular text
\newcommand{\nrank}{\operatorname{rank}_+}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\conv}{\operatorname{conv}}
\newcommand{\xc}{\operatorname{xc}}
\renewcommand{\R}{\mathbb{R}}

\newcommand{\vnote}[1]{{\color{magenta}\noindent\textbf{V: }\marginpar{****}\textit{{#1}}}}
\newcommand{\mnote}[1]{{\color{blue}\noindent\textbf{M: }\marginpar{****}\textit{{#1}}}}

\begin{document}
\maketitle

\section{Introduction}

Assuming $\P \ne \NP$, any linear program (LP) for the traveling salesperson problem (\lang{TSP}) must be of super-polynomial size, otherwise one could use the ellipsoid method or interior point method to solve a polynomial-size LP for $\lang{TSP}$ in polynomial time, refuting $\P \ne \NP$. It is also interesting to consider the converse of this statement: if there exists a polynomial-size LP for $\lang{TSP}$, then $\P = \NP$ as $\lang{TSP}$ is $\NP$-complete. This motivates the following question: can we write a polynomial size LP for $\lang{TSP}$? The work of Fiorini~\cetal~\cite{fiorini} attempts to resolve this question and their work is the subject of this exposition.

\subsection{Problem Statement}

The problem is simply stated: find super-polynomial lower bounds for the size of any LP for $\lang{TSP}$. This seemingly daunting task motivates the following definition. 

\begin{definition}[Extended Formulation]
Let $b,d$ be column vectors and let $A$, $B$, and $C$ be real matrices with $n$, $n$, and $r$ columns, respectively. Let $P = \{x \in \R^n : Ax \le b\}$ and $Q = \{(x,y) \in \R^n \times \R^r : Bx + Cy \le d\}$. We say that $Q$ is an \emph{extended formulation} (EF) of $P$ if $P = \{x : \exists y \in \R^r, (x,y) \in Q\}$. The size of $Q$, the EF of $P$, is the number of entries in $d$. That is, the size of the EF $Q$ is the number of inequalities defining $Q$. The \emph{extension complexity} of $P$, denoted by $\xc(P)$, is the minimum size EF of $P$.
\end{definition}

At a basic level, an EF of a polytope $P$ is a polytope $Q$ in a higher-dimensional space with a different set of constraints, but is in essence equivalent to $P$. It is equivalent in the sense that one can optimize over an EF $Q$ of $P$ to optimize over $P$. However, we gain nothing if $Q$ is more complex than $P$. Suppose, for instance, that $P$ is a polytope with $n$ variables and an exponential number of constraints. If there exists an EF $Q$ of $P$ with a polynomial number of variables and constraints in $n$, then it would be possible to optimize over $Q$ in polynomial time as a way of optimizing over $P$. It is not immediately evident that there should even be EFs that can save an exponential number of constraints at the expense of increasing the number of variables polynomially. We give an example in Section~(\ref{sec:utility-EF}) that shows the existence of such an EF.

The notion of an EF gives a direction towards answering the question posed at the beginning of this section. In particular, if one could show that the extension complexity of the $\lang{TSP}$ polytope is exponential, then there would not exist a polynomial-size LP for $\lang{TSP}$. More formally, we are interested in the following problem.

\begin{probstate}
Consider an instance to the Traveling Salesman Problem (TSP), where the input size, i.e. the number of cities is $n$. Let $TSP(n)$ be a polytope such that every point $x \in TSP(n)$ corresponds to a feasible solution to TSP, and vice-versa. Does there exist an extended formulation $Q$ of $TSP(n)$ of polynomial size, i.e. with a polynomial number of inequalities? In other words, is the extension complexity of $TSP(n)$ polynomial with respect to $n$?
\end{probstate}

In Section~(\ref{sec:Yannakakis}), we will show interesting connections between extension complexity and communication complexity that will aid in settling this problem statement in the negative, by showing that the extension complexity of the $\lang{TSP}$ polytope is exponential with respect to the input size.

\subsection{The Utility of Extended Formulations}
\label{sec:utility-EF}

In this subsection, we give an example of an extended formulation of a particular polytope that reduces the number of constraints from exponential to polynomial and only increases the number of variables by a polynomial factor. This example was given in the lecture notes by Vondr\'ak~\cite{vondrak-class}.

\begin{example}
The permutahedron $P_{perm}^{(n)}$ is the convex hull of the permutation group on $[n]$. Formally, let 
\[
P_{perm}^{(n)} = \conv(\{(\pi(1), \ldots, \pi(n)) : \pi \in S_n\}) \subset \R^n,
\]

where $\conv$ denotes convex hull. Writing this polytope in terms of constraints, we have
\begin{equation}\label{eq:perm}
P_{perm}^{(n)} = \left\{x \in \R^n : \sum_{i=1}^n x_i = \binom{n+1}{2}; \forall S \subseteq [n], \sum_{i\in S} x_i \ge \binom{\abs{S} + 1}{2}\right\}.
\end{equation}
To see that the sets are the same, consider a vertex $(x_1, \ldots, x_n)$ in $P_{perm}^{(n)}$. As $(x_1, \ldots, x_n)$ is a permutation of $[n]$, it follows that $\sum_{i=1}^n x_i = n(n+1)/2$, which is the first constraint in~(\ref{eq:perm}). Furthermore, every subset $S \subseteq \{x_1, \ldots, x_n\}$ must also sum to at least $\binom{\abs{S} + 1}{2}$, which is the other set of constraints in~(\ref{eq:perm}). These constraints hold for permutations of $[n]$ as $S$ will only be permutations of subsets of $[n]$. Note that $x_{i_1} + x_{i_2} + \cdots + x_{i_k} = \binom{k + 1}{2}$ if and only if $x_{i_1}, \ldots, x_{i_k}$ are a permutation of $[k]$. It is then clear that any convex combination of $\{(\pi(1), \ldots, \pi(n)) : \pi \in S_n\}$ also satisfies these constraints.

It is clear that the number of constraints in~(\ref{eq:perm}) is exponential. There is a straightforward way to reduce this number. Let $\pi \in S_n$. Consider the matrix $Y_\pi \in \R^{n \times n}$ defined such that $Y_{ij} = 1$ if $j = \pi(i)$ and $0$ otherwise. In other words, $Y_{ij}$ is $1$ if $i$ maps to $j$ under $\pi$. This mapping can be thought of as a perfect matching between two vertex sets $V_1 = [n]$ and $V_2 = [n]$. That is, $Y_\pi$ defines a perfect matching on $K_{n,n}$, the complete bipartite graph and therefore $\conv(\{Y_\pi : \pi \in S_n\})$ is the bipartite perfect matching polytope on $K_{n,n}$. Fortunately, we know straightforward characterizations of the bipartite perfect matching polytope. 

Formally, let $B_{n}$ be the bipartite perfect matching polytope on $K_{n,n}$. Then 
\[
B_n = \left\{ y \in \R^{n \times n} : y_{ij} \ge 0; \forall i, \sum_{j=1}^n y_{ij} = 1; \forall j, \sum_{i=1}^n y_{ij} = 1\right\}.
\]
The nontrivial constraints essentially ensure that every vertex on each side of the bipartition is matched to a vertex on the other side of the bipartition. Then we observe that each perfect matching directly corresponds to a permutation. Thus, we have the following extended formulation
\[
Q = \left\{(x,y) \in \R^n \times \R^{n \times n} : y_{ij} \ge 0, \forall i, x_i = \sum_{j=1}^n j \cdot y_{ij}; \forall i, \sum_{j=1}^n y_{ij} = 1; \forall j, \sum_{i=1}^n y_{ij} = 1\right\}.
\]
Then, we finally have that $P_{perm}^{(n)} = \{x \in \R^n : \exists y \in \R^{n \times n}, (x,y) \in Q\}$. It is clear that $Q$ has $n + n^2$ variables and a polynomial number of constraints. Thus, the extension complexity of the permutahedron is polynomial. 
\end{example}

\subsection{Yannakakis's Approach}
\label{sec:Yannakakis}

\subsection{Prior Related Work}


\section{Symmetric $\lang{TSP}$ Polytope}

\begin{theorem}[Factorization Theorem]\label{theor:factor}
\end{theorem}

\section{Connections to Communication Complexity}

\subsection{Thorem $4$}\label{sec:theorem4}

\begin{theorem}\label{theor:suppmat}
\end{theorem}

\subsection{Rectangle Covering Bound}\label{sec:rec-cover}


De Wolf \cite{de-wolf} showed the following theorem.
\begin{theorem}\label{theor:dewolf}
Every $1$-monochromatic rectangle cover of suppmat$(M)$ has size $2^{\Omega(n)}$.
\end{theorem}
\begin{proof}
\end{proof}

\section{Lower Bounds for $CUT(n)$ Polytope}

This section describes the first of the results in \cite{fiorini}, by showing that the $CUT(n)$ polytope has exponential extension complexity. We briefly sketch the proof here, before proceeding more formally. The result essentially lies on a connection between the $CUT(n)$ polytope and the correlation polytope, shown by \cite{de-simone}. The authors use Yannakakis's Theorem \ref{theor:factor} to relate the extension complexity of the correlation polytope with the nonnegative rank of a matrix, and then use Yannakakis's Theorem \ref{theor:suppmat} and De Wolf's Theorem \ref{theor:dewolf} to lower bound it by $2^{cn}$ for some positive constant $c$, implying an exponential lower bound on the extension complexity of the $CUT(n)$ polytope.

Before we proceed, we first need to provide some definitions, starting with the cut polytope $CUT(n)$.

Let $K_n = (V_n, E_n)$ be the complete graph with $n$ vertices. Then, for a cut $\delta(X)$, $\chi^{\delta(X)} \in \R^{E_n}$ is a characteristic vector of the cut, where for a single edge $e$, $\chi^{\delta(X)}_e$ is defined as
\[
\chi^{\delta(X)}_e =
\begin{cases}
1 & e \in \delta(X) \\
0 & e \notin \delta(X)
\end{cases}
\]

\begin{definition}[Cut Polytope]\label{def:cut-poly}
The \textit{cut polytope} $CUT(n)$ is defined as the convex hull of the characteristic vectors of all possible cuts in $K_n = (V_n, E_n)$. In other words
\[
CUT(n) \coloneqq conv\left( \left\{ \chi^{\delta(X)} \in \R^{E_n} \mid X \subseteq V_n \right\} \right)
\]
\end{definition}

Next, we define the notion of \textit{linear isomorphism} of two polytopes.

\begin{definition}[Linearly Isomorphic Polytopes]\label{def:lin-iso}
Two polytopes $P \subseteq \R^n$ and $Q \subseteq \R^m$ are called \textit{linearly isomorphic} if there exists an invertible matrix $M \in \R^{n \times m}$ such that for every $x \in P$, $y = Mx \in Q$. Equivalently, for every $y \in Q$, $x = M^{-1}y \in P$.
\end{definition}

Intuitively, if two polytopes are linearly isomorphic, you can obtain one from the other by applying an invertible linear map. It also follows easily that two linearly isomorphic polytopes have the same number of vertices and facets, and any EF of one polytope can be extended to an EF of the other polytope by using the same invertible linear map. The latter is very important for our analysis, as it implies that a bound on the extension complexity of one polytope applies to any other polytope that is linearly isomorphic to it.

Next, we provide a useful definition of the \textit{correlation polytope}.

\begin{definition}[Correlation Polytope]\label{def:cor}
Let $b \in {\{0, 1\}}^n$. Then $b b^T$ is a rank-$1$ binary symmetric matrix. The convex hull of all rank-$1$ binary symmetric matrices is called
the \textit{correlation (or Boolean quadric) polytope}, and is denoted by
\[
COR(n) \coloneqq conv\left( \left\{ bb^T \in \R^{n \times n} \mid b \in {\{0, 1\}}^n \right\} \right)
\]
\end{definition}

We are now ready to show the main result of this section, that provides a lower bound on the extension complexity of the $CUT(n)$ polytope.

\begin{theorem}\label{theor:cut}
There exists some constant $c > 0$ such that for all $n$,
\[
xc(CUT(n+1)) \geq 2^{c(n)}
\]
\end{theorem}
\begin{proof}
De Simone \cite{de-simone} showed the following Lemma, which the authors make use of and we state here without proof

\begin{lemma}\label{lem:cut-cor}
For all $n$, $COR(n)$ is linearly isomorphic to $CUT(n+1)$.
\end{lemma}

We note that, for any $a \in {\{0, 1\}}^n$, the inequality
\begin{equation}\label{eq:cor-valid}
\left\langle 2 \; \text{diag}(a) - aa^T, x \right\rangle \leq 1
\end{equation}
is satisfied by all vertices $bb^T$ of $COR(n)$, as this inequality is equivalent to ${(1 - a^Tb)}^2 \geq 0$, as seen in Section \ref{sec:rec-cover}. By convexity of $COR(n)$, we get that this inequality is satisfied by all points of $COR(n)$, and thus it is valid for $COR(n)$. Also note that these inequalities correspond to the entries of the matrix $M$ of Section \ref{sec:rec-cover}, as
\[
M_{ab} = 1 - \left\langle 2 \; \text{diag}(a) - aa^T, x \right\rangle
\]

Consider now any system of linear inequalities that describes $COR(n)$, and starts with the $2^n$ inequalities of \eqref{eq:cor-valid}. If we delete all but the first $2^n$ rows of any slack matrix $S$ with respect to this system of inequalities and $\{bb^T \mid b \in {\{0, 1\}}^n \}$, the resulting $2^n \times 2^n$ matrix is exactly $M$. By Theorem \ref{theor:factor}, we get that
\begin{equation}\label{eq:cut1}
xc(COR(n)) = rank_+(S)
\end{equation}
Since the nonnegative rank of a matrix is at least the nonnegative rank of any of its submatrices, we have
\begin{equation}\label{eq:cut2}
rank_+(S) \geq rank_+(M)
\end{equation}
By Theorem \ref{theor:suppmat}, $rank_+(M)$ is lower bounded by the rectangle covering bound for suppmat$(M)$, and finally, by Theorem \ref{theor:dewolf}, we have that every $1$-monochromatic rectangle cover of suppmat$(M)$ has size $2^{\Omega(n)}$. Therefore, there exists a constant $c > 0$, such that
\begin{equation}\label{eq:cut3}
rank_+(M) \geq 2^{cn}
\end{equation}
Combining Lemma \ref{lem:cut-cor} with equations \eqref{eq:cut1}, \eqref{eq:cut2} and \eqref{eq:cut3}, we get
\[
xc(CUT(n+1)) \geq 2^{cn}
\]
for some constant $c > 0$.
\end{proof}

Theorem \ref{theor:cut} immediately implies the following.

\begin{corollary}\label{cor:cut}
The extension complexity of $CUT(n)$ is $2^{\Omega(n)}$.
\end{corollary}

\section{$STAB(n)$ and $TSP(n)$ Polytopes}


\section{Conclusion}

\bibliographystyle{unsrt}
\bibliography{refs}
\end{document}
